import React, { useState, useEffect } from "react";
import { FullPage, Slide } from 'react-full-page';
import Authorize from "./component/authorize";
import "./css/main.css";
import Figure from "./component/figure";
import p1 from "./img/promo-0.png";
import p2 from "./img/promo-1.png";
import { useDidMount } from "rooks";


/////////////////////////////////////////////////////
const GM =(props)=> (
    <svg className="gm"
        height="32px"
        style={{enableBackground:"new 0 0 32 32",visibility:"hidden"}}
        version="1.1" 
        viewBox="0 0 32 32" 
        width="32px"
        xmlns="http://www.w3.org/2000/svg"
        onClick={props.open}
    >
        <path fill="white" d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z" />
    </svg>
);
const Promo =(props)=> {
    return(
        <div className="Promo">
            <img height="150px" style={{marginRight:"2%"}} src={p1}/>
            <img height="150px" src={p2}/>
        </div>
    );
}
const Footer =(props)=> {
    return(
        <footer>
            <h4 style={{textAlight:"center",marginLeft:"45%",color:"black"}}>@rex 2021</h4>
        </footer>
    );
}
const Logo =(props)=> (
        <svg xmlns="http://www.w3.org/2000/svg" 
            version="1.1" 
            width="25%"
            height="25%"
            style={{marginLeft:"35%"}}
            //style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
            viewBox={`0 0 160 125`}
        >
            
            <path fill="#2B2A29" d="M42.17 78.74c-0.14,0 -0.3,-0.04 -0.5,-0.11 -0.2,-0.07 -6.64,-4.56 -19.33,-13.47 -0.2,-0.16 -0.36,-0.38 -0.51,-0.65 -0.14,-0.26 -0.21,-0.51 -0.21,-0.73 0,-0.48 0.19,-0.89 0.55,-1.24 0.37,-0.35 0.77,-0.53 1.22,-0.53l12.61 0c1.37,0 2.53,-0.48 3.46,-1.45 0.94,-0.96 1.41,-2.12 1.41,-3.46 -0.05,-1.38 -0.56,-2.53 -1.51,-3.47 -0.95,-0.94 -2.1,-1.41 -3.45,-1.41l-17.69 0c-0.25,0 -0.39,0.14 -0.42,0.42l0 24.33c0,0.45 -0.16,0.84 -0.48,1.18 -0.32,0.34 -0.72,0.5 -1.2,0.5 -0.45,0 -0.84,-0.16 -1.18,-0.5 -0.33,-0.34 -0.5,-0.74 -0.5,-1.22l0 -26.39c0,-0.48 0.17,-0.88 0.5,-1.2 0.34,-0.32 0.73,-0.48 1.18,-0.48l19.88 0c2.27,0 4.21,0.81 5.82,2.44 1.61,1.62 2.41,3.57 2.41,5.84 0,2.27 -0.82,4.21 -2.45,5.82 -1.64,1.61 -3.6,2.41 -5.87,2.41 -4.51,0 -6.79,0.02 -6.85,0.07 -0.05,0.04 -0.08,0.09 -0.08,0.14 0,0.09 0.04,0.16 0.13,0.21l14.03 9.88c0.2,0.14 0.37,0.34 0.51,0.61 0.14,0.27 0.21,0.51 0.21,0.73 0,0.48 -0.17,0.89 -0.51,1.22 -0.33,0.34 -0.73,0.51 -1.18,0.51zm33.88 -0.51l-26.77 0c-0.45,0 -0.84,-0.17 -1.18,-0.52 -0.34,-0.35 -0.5,-0.75 -0.5,-1.2l0 -26.01c0,-0.48 0.16,-0.88 0.5,-1.2 0.34,-0.32 0.73,-0.48 1.18,-0.48l26.72 0c0.51,0 0.92,0.16 1.24,0.5 0.33,0.34 0.49,0.74 0.49,1.22 0,0.45 -0.16,0.83 -0.49,1.15 -0.32,0.33 -0.72,0.49 -1.19,0.49l-24.63 0c-0.11,0 -0.21,0.04 -0.29,0.12 -0.09,0.09 -0.13,0.19 -0.13,0.3l0 9.03c0,0.12 0.04,0.21 0.13,0.3 0.08,0.08 0.18,0.12 0.29,0.12l18.62 0c0.5,0 0.91,0.17 1.24,0.51 0.32,0.33 0.48,0.74 0.48,1.22 0,0.45 -0.18,0.83 -0.53,1.15 -0.35,0.32 -0.75,0.49 -1.19,0.49l-18.62 0c-0.11,0 -0.21,0.04 -0.29,0.12 -0.09,0.09 -0.13,0.18 -0.13,0.3l0 8.61c0,0.11 0.04,0.21 0.13,0.3 0.08,0.08 0.18,0.12 0.29,0.12l24.58 0c0.51,0 0.92,0.17 1.24,0.51 0.33,0.33 0.49,0.74 0.49,1.21 0,0.45 -0.16,0.84 -0.49,1.16 -0.32,0.32 -0.72,0.48 -1.19,0.48zm33.24 0.42c-0.23,0 -0.47,-0.06 -0.72,-0.19 -0.25,-0.12 -0.46,-0.28 -0.63,-0.48l-8.53 -11.18c-0.87,-1.12 -2,-1.68 -3.4,-1.68 -1.35,0 -2.41,0.53 -3.2,1.6l-8.7 11.26c-0.14,0.2 -0.34,0.36 -0.6,0.48 -0.27,0.13 -0.52,0.19 -0.74,0.19 -0.45,0 -0.84,-0.16 -1.18,-0.5 -0.33,-0.34 -0.5,-0.73 -0.5,-1.18 0,-0.17 0.03,-0.33 0.08,-0.5 0.06,-0.17 2.89,-3.95 8.49,-11.35 0.14,-0.19 0.27,-0.45 0.38,-0.75 0.11,-0.31 0.17,-0.59 0.17,-0.85 0,-0.56 -0.18,-1.1 -0.55,-1.63l-8.19 -10.8c-0.25,-0.31 -0.38,-0.66 -0.38,-1.05 0,-0.48 0.17,-0.88 0.5,-1.2 0.34,-0.33 0.73,-0.49 1.18,-0.49 0.22,0 0.47,0.07 0.74,0.19 0.26,0.13 0.46,0.29 0.6,0.49l8.7 11.3c0.31,0.42 0.75,0.79 1.31,1.11 0.56,0.33 1.19,0.49 1.89,0.49 1.37,0 2.51,-0.56 3.4,-1.68l8.53 -11.22c0.17,-0.17 0.38,-0.32 0.63,-0.44 0.25,-0.13 0.49,-0.19 0.72,-0.19 0.47,0 0.87,0.16 1.2,0.48 0.32,0.32 0.48,0.72 0.48,1.2 0,0.39 -0.11,0.73 -0.34,1.01l-8.15 10.8c-0.17,0.22 -0.3,0.49 -0.4,0.79 -0.1,0.31 -0.15,0.59 -0.15,0.84 0,0.57 0.19,1.11 0.55,1.64l8.15 10.8c0.23,0.28 0.34,0.62 0.34,1.01 0,0.45 -0.16,0.84 -0.48,1.18 -0.33,0.34 -0.73,0.5 -1.2,0.5z"/>
            <path fill="#2B2A29" d="M131.81 75.68l0 0.08 0 22.05c0,0.37 -0.14,0.68 -0.41,0.95 -0.27,0.27 -0.59,0.41 -0.95,0.41 -0.38,0 -0.7,-0.14 -0.96,-0.41 -0.27,-0.27 -0.4,-0.58 -0.4,-0.95l0 -17.89 -8.39 11.41 -0.03 0.04c-0.04,0.04 -0.09,0.09 -0.14,0.13l-0.08 0.08c-0.01,0 -0.01,0 -0.01,0.02 0,0.01 -0.01,0.02 -0.02,0.02 -0.01,0 -0.02,0 -0.02,0 -0.02,0 -0.04,0 -0.04,0.02 -0.09,0.05 -0.18,0.11 -0.27,0.15 -0.01,0.01 -0.03,0.02 -0.06,0.02 -0.02,0 -0.04,0 -0.05,0 -0.11,0.03 -0.24,0.05 -0.36,0.05l0 0.02 0 -0.02c-0.13,0 -0.26,-0.02 -0.37,-0.05 -0.01,0 -0.03,0 -0.06,0 -0.03,0 -0.04,-0.01 -0.06,-0.02 -0.08,-0.04 -0.17,-0.1 -0.27,-0.15 0,-0.02 0,-0.02 -0.02,-0.02 -0.01,0 -0.02,0 -0.04,0 -0.01,0 -0.01,-0.01 -0.01,-0.02 0,-0.02 0,-0.02 -0.02,-0.02l-0.08 -0.08c-0.05,-0.04 -0.09,-0.09 -0.13,-0.13l-0.04 -0.04 -8.38 -11.41 0 17.89c0,0.37 -0.13,0.68 -0.4,0.95 -0.27,0.27 -0.59,0.41 -0.96,0.41 -0.37,0 -0.69,-0.14 -0.96,-0.41 -0.26,-0.27 -0.4,-0.58 -0.4,-0.95l0 -22.05 0 -0.08c0,-0.01 0,-0.04 0.01,-0.08 0.01,-0.03 0.01,-0.06 0.01,-0.07 0,-0.07 0,-0.11 0.02,-0.14l0.06 -0.11c0,-0.01 0,-0.03 0.02,-0.06 0.01,-0.02 0.02,-0.04 0.02,-0.06 0,-0.01 0,-0.03 0.02,-0.06 0.02,-0.02 0.03,-0.04 0.05,-0.05 0.01,-0.02 0.03,-0.03 0.05,-0.06 0.02,-0.02 0.03,-0.04 0.03,-0.06 0.01,-0.02 0.03,-0.06 0.07,-0.09l0.12 -0.12c0.01,-0.01 0.03,-0.03 0.07,-0.05l0.02 0c0.04,-0.04 0.09,-0.08 0.14,-0.1 0.01,-0.02 0.03,-0.02 0.05,-0.02 0.02,0 0.03,-0.01 0.04,-0.02l0.12 -0.05c0.01,0 0.03,-0.01 0.07,-0.02 0.03,-0.02 0.05,-0.02 0.06,-0.02 0.01,0 0.03,-0.01 0.06,-0.02 0.03,0 0.05,0 0.06,0l0.15 0 0.04 -0.02c0.01,0 0.03,0 0.04,0 0.01,0.01 0.02,0.02 0.04,0.02 0.02,0 0.05,0 0.08,0 0.02,0.01 0.04,0.02 0.07,0.02 0.06,0 0.11,0 0.14,0.02 0.01,0.01 0.03,0.02 0.05,0.02 0.03,0 0.05,0 0.06,0.01l0.11 0.06c0.02,0.01 0.04,0.03 0.07,0.05 0.03,0.02 0.06,0.03 0.07,0.03 0.01,0 0.03,0.01 0.05,0.04 0.02,0.02 0.03,0.04 0.04,0.04 0.03,0.01 0.06,0.03 0.1,0.07l0.11 0.11 0.06 0.06 9.75 13.27 9.73 -13.27c0.02,-0.01 0.04,-0.03 0.08,-0.06 0.01,-0.01 0.03,-0.03 0.05,-0.05 0.02,-0.03 0.03,-0.05 0.04,-0.06 0.04,-0.04 0.08,-0.06 0.1,-0.07 0.05,-0.06 0.09,-0.09 0.11,-0.1 0.02,-0.02 0.04,-0.03 0.06,-0.04 0.02,-0.02 0.03,-0.02 0.04,-0.02 0.02,0 0.03,-0.01 0.07,-0.02 0.03,-0.01 0.06,-0.03 0.07,-0.04 0.01,-0.01 0.03,-0.01 0.05,-0.01 0.03,0 0.05,-0.01 0.06,-0.02 0.03,-0.02 0.07,-0.02 0.14,-0.02 0.01,0 0.03,-0.01 0.06,-0.02 0.04,0 0.06,0 0.07,0 0.01,0 0.03,-0.01 0.04,-0.02 0.02,0 0.04,0 0.06,0l0.04 0c0.02,0 0.04,0 0.07,0 0.02,0.01 0.05,0.02 0.08,0.02 0.01,0 0.03,0 0.06,0 0.02,0.01 0.04,0.02 0.05,0.02 0.03,0 0.06,0.01 0.12,0.04 0.01,0 0.04,0 0.06,0.01 0.03,0.01 0.06,0.02 0.07,0.02 0.02,0 0.03,0.01 0.05,0.02 0.02,0.01 0.03,0.02 0.04,0.04 0.08,0.04 0.13,0.06 0.14,0.08l0.04 0.02 0.06 0.05 0.11 0.12c0.04,0.03 0.07,0.07 0.08,0.09 0,0.02 0.01,0.03 0.04,0.05 0.03,0.02 0.04,0.04 0.04,0.05 0,0.01 0.01,0.03 0.02,0.05 0.02,0.03 0.04,0.05 0.05,0.06 0,0.02 0.01,0.04 0.02,0.07 0.01,0.03 0.03,0.06 0.04,0.07 0.01,0.01 0.02,0.03 0.02,0.05 0,0.03 0.01,0.05 0.02,0.06 0.01,0.03 0.02,0.07 0.02,0.14 0,0.01 0,0.04 0.01,0.07 0,0.04 0.01,0.07 0.01,0.08zm25.43 -1.28c0.38,0 0.7,0.13 0.97,0.4 0.27,0.27 0.4,0.59 0.4,0.97 0,0.37 -0.13,0.7 -0.4,0.96l-10.6 10.61 0 10.47c0,0.37 -0.14,0.68 -0.41,0.95 -0.27,0.27 -0.58,0.41 -0.95,0.41 -0.38,0 -0.7,-0.14 -0.97,-0.41 -0.27,-0.27 -0.4,-0.58 -0.4,-0.95l0 -10.47 -10.6 -10.61c-0.27,-0.26 -0.4,-0.59 -0.4,-0.96 0,-0.38 0.13,-0.7 0.4,-0.97 0.27,-0.27 0.59,-0.4 0.96,-0.4 0.37,0 0.69,0.13 0.96,0.4l10.05 10.04 10.02 -10.04c0.27,-0.27 0.59,-0.4 0.97,-0.4z"/>
            <path fill="#E31E24" d="M106.17 106.35c-9.23,9.19 -21.07,15.17 -33.68,17.28 -12.27,2.06 -25.29,0.47 -37.34,-5.36 -15.47,-7.48 -26.44,-20.53 -31.68,-35.57 -5.23,-15.04 -4.73,-32.08 2.75,-47.55 7.49,-15.47 20.53,-26.44 35.57,-31.68 15.05,-5.23 32.08,-4.73 47.55,2.75 12.05,5.83 21.37,15.03 27.37,25.91 6.17,11.19 8.85,24.16 7.39,37.08l-2.81 -0.31c1.39,-12.34 -1.16,-24.72 -7.06,-35.41 -5.73,-10.38 -14.62,-19.16 -26.12,-24.72 -14.76,-7.15 -31.03,-7.63 -45.39,-2.63 -14.36,4.99 -26.81,15.47 -33.95,30.24 -7.15,14.77 -7.63,31.03 -2.63,45.39 4.99,14.36 15.47,26.81 30.24,33.95 11.51,5.57 23.93,7.09 35.65,5.12 12.04,-2.02 23.34,-7.72 32.15,-16.49l1.99 2z"/>
        </svg>
);
/////////////////////////////////////////////////////


export default function Main(props) {
    const [regForm, setRegForm] = useState()
    const [head, onHead] = useState(<GM open={verify}/>)

    const verify =()=> {
        let data = store.get("user")
        
        if(data.login && data.password){
            socket.emit("init", {login:data.login, password:data.password})
        }
        else setTimeout(()=> onHead(<GM open={verify}/>), 6000)
    }
    const onLoad =()=> {
        onHead(
            <React.Fragment>
                <GM open={verify}/>
                <var style={{color:"brown", marginLeft:"2%",fontSize:"18px"}}>Воспользуйтесь формой регистрации/авторизации</var>
            </React.Fragment>
        );
        setRegForm(
            <Authorize 
                onOk={(userData)=> {
                    store.set("user", userData)
                    props.useRender(userData)
                }}
                onErr={(textError)=> {
                    onHead(
                        <React.Fragment>
                            <GM open={verify}/>
                            <h3 style={{color:"brown", marginLeft:"5%"}}>{textError}</h3>
                        </React.Fragment>
                    );
                    setTimeout(()=> onHead(<GM open={verify}/>), 6000)
                }}
            />
        );
        setTimeout(()=> verify(), 300)
    }
    useDidMount(()=> {
        onLoad()
    })
    
    return(
        <FullPage>
            <Slide className="section-1"> 
                <header>{ head }</header>
                <Figure/>
                <Logo />
                { regForm }
            </Slide>
        </FullPage>
    );
}


/**
 * <Slide className="section-2">
                <img src={ p2 } style={{width:"110vw"}}/>
            </Slide>
            <Slide className="section-3"> 
                <img src={ p1 } style={{opacity:"0.6"}}/>
            </Slide>
 */